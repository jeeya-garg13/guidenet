

        if (isset($_FILES["profilePicture"]) && $_FILES["profilePicture"]["error"] == 0) {
            $upload_dir = "uploads/profile_pics/";

            if (!is_dir($upload_dir)) {
                mkdir($upload_dir, 0777, true);
            }
/*
        // Fetch old profile picture path from database
        $query = "SELECT PROFILEPICTURE FROM stud_registration WHERE ID = '$id'";
        $result = $conn->query($query);
        $row = $result->fetch_assoc();
        $oldProfilePicture = $row["PROFILEPICTURE"];
/*
        // Initialize profile picture filename
        $newProfilePicture = $oldProfilePicture;

        // Handle profile picture upload
        if (!empty($_FILES["profilePicture"]["tmp_name"])) {
            $fileExt = pathinfo($_FILES["profilePicture"]["name"], PATHINFO_EXTENSION);
            $newFileName = "user_" . $id . "." . $fileExt;
            $filePath = $uploadDir . $newFileName;

        // Delete the old profile picture if it exists
            if (!empty($oldProfilePicture) && file_exists($uploadDir . $oldProfilePicture)) {
                unlink($uploadDir . $oldProfilePicture);
            }

        // Move the new uploaded file to the server folder
            if (move_uploaded_file($_FILES["profilePicture"]["tmp_name"], $filePath)) {
                //$newProfilePicture = $newFileName;  // Update new profile picture filename
                // Update database with new file path
            $updateQuery = "UPDATE stud_registration SET PROFILEPICTURE = ? WHERE ID = ?";
            $stmt = $conn->prepare($updateQuery);
            $stmt->bind_param("ss", $filePath, $id);
            if ($stmt->execute()) {
                $message = "Profile picture updated successfully!";
                $profile_picture = $filePath; // Update displayed picture
            } else {
                $message = "Error updating database.";
            }
            $stmt->close();

            } else {
                echo "Error uploading new profile picture.";
                exit;
            }
        }   
*/
        if ($_FILES["profilePicture"]["error"] == 0) {
            $file_tmp = $_FILES["profilePicture"]["tmp_name"];
            $file_ext = pathinfo($_FILES["profilePicture"]["name"], PATHINFO_EXTENSION);
            $newFileName = "user_" . $id . "." . $file_ext; // Unique filename based on ID
            $upload_path = $upload_dir . $newFileName;

    // Delete old profile picture if it exists
            if (!empty($oldProfilePicture) && file_exists($upload_dir . $oldProfilePicture)) {
                unlink($upload_dir . $oldProfilePicture);
            }

    // Move new profile picture to the upload directory
            if (move_uploaded_file($file_tmp, $upload_path)) {
        // Update the database with the new profile picture filename
                $update_query = "UPDATE stud_registration SET PROFILEPICTURE = ? WHERE ID = ?";
                $stmt = $conn->prepare($update_query);
                $stmt->bind_param("ss", $newFileName, $id);
                $stmt->execute();

            echo "Profile picture updated successfully!";
            } else {
                echo "Error uploading the profile picture.";
            }
        }



/*
        // Update database with the new profile picture filename
        $updateQuery = "UPDATE stud_registration SET 
        NAME='$name', STATE='$state', ABOUT='$about', DOB='$dob', 
        COURSE='$course', BRANCH='$branch', LANGUAGES='$language', 
        INTERNSHIP='$internship', PROFILEPICTURE='$newProfilePicture' 
        WHERE ID='$id'";
*/